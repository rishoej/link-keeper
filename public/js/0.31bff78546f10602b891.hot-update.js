webpackHotUpdate(0,{

/***/ 69:
/***/ (function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.facebookLogin = facebookLogin;\nexports.twitterLogin = twitterLogin;\nexports.googleLogin = googleLogin;\nexports.link = link;\nexports.unlink = unlink;\n\nvar _url = __webpack_require__(582);\n\nvar _url2 = _interopRequireDefault(_url);\n\nvar _querystring = __webpack_require__(259);\n\nvar _querystring2 = _interopRequireDefault(_querystring);\n\nvar _moment = __webpack_require__(1);\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _reactCookie = __webpack_require__(260);\n\nvar _reactCookie2 = _interopRequireDefault(_reactCookie);\n\nvar _reactRouter = __webpack_require__(33);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Sign in with Facebook\nfunction facebookLogin() {\n  var facebook = {\n    url: '/auth/facebook',\n    clientId: '980220002068787',\n    redirectUri: '/auth/facebook/callback',\n    authorizationUrl: 'https://www.facebook.com/v2.5/dialog/oauth',\n    scope: 'email,user_location',\n    width: 580,\n    height: 400\n  };\n\n  return function (dispatch) {\n    oauth2(facebook, dispatch).then(openPopup).then(pollPopup).then(exchangeCodeForToken).then(signIn).then(closePopup);\n  };\n}\n\n// Sign in with Twitter\nfunction twitterLogin() {\n  var twitter = {\n    url: '/auth/twitter',\n    redirectUri: '/auth/twitter/callback',\n    authorizationUrl: 'https://api.twitter.com/oauth/authenticate'\n  };\n\n  return function (dispatch) {\n    oauth1(twitter, dispatch).then(openPopup).then(getRequestToken).then(pollPopup).then(exchangeCodeForToken).then(signIn).then(closePopup);\n  };\n}\n\n// Sign in with Google\nfunction googleLogin() {\n  var google = {\n    url: '/auth/google',\n    clientId: '814958990796-p1centjebv1k0htp3am05tfg5k10nl0k.apps.googleusercontent.com',\n    redirectUri: '/auth/google/callback',\n    authorizationUrl: 'https://accounts.google.com/o/oauth2/auth',\n    scope: 'openid profile email',\n    width: 452,\n    height: 633\n  };\n\n  return function (dispatch) {\n    oauth2(google, dispatch).then(openPopup).then(pollPopup).then(exchangeCodeForToken).then(signIn).then(closePopup);\n  };\n}\n\n// Link account\nfunction link(provider) {\n  switch (provider) {\n    case 'facebook':\n      return facebookLogin();\n    case 'twitter':\n      return twitterLogin();\n    case 'google':\n      return googleLogin();\n    default:\n      return {\n        type: 'LINK_FAILURE',\n        messages: [{ msg: 'Invalid OAuth Provider' }]\n      };\n  }\n}\n\n// Unlink account\nfunction unlink(provider) {\n  return function (dispatch) {\n    return fetch('/unlink/' + provider).then(function (response) {\n      if (response.ok) {\n        return response.json().then(function (json) {\n          dispatch({\n            type: 'UNLINK_SUCCESS',\n            messages: [json]\n          });\n        });\n      } else {\n        return response.json().then(function (json) {\n          dispatch({\n            type: 'UNLINK_FAILURE',\n            messages: [json]\n          });\n        });\n      }\n    });\n  };\n}\n\nfunction oauth2(config, dispatch) {\n  return new Promise(function (resolve, reject) {\n    var params = {\n      client_id: config.clientId,\n      redirect_uri: config.redirectUri,\n      scope: config.scope,\n      display: 'popup',\n      response_type: 'code'\n    };\n    var url = config.authorizationUrl + '?' + _querystring2.default.stringify(params);\n    resolve({ url: url, config: config, dispatch: dispatch });\n  });\n}\n\nfunction oauth1(config, dispatch) {\n  return new Promise(function (resolve, reject) {\n    resolve({ url: 'about:blank', config: config, dispatch: dispatch });\n  });\n}\n\nfunction openPopup(_ref) {\n  var url = _ref.url,\n      config = _ref.config,\n      dispatch = _ref.dispatch;\n\n  return new Promise(function (resolve, reject) {\n    var width = config.width || 500;\n    var height = config.height || 500;\n    var options = {\n      width: width,\n      height: height,\n      top: window.screenY + (window.outerHeight - height) / 2.5,\n      left: window.screenX + (window.outerWidth - width) / 2\n    };\n    var popup = window.open(url, '_blank', _querystring2.default.stringify(options, ','));\n\n    if (url === 'about:blank') {\n      popup.document.body.innerHTML = 'Loading...';\n    }\n\n    resolve({ window: popup, config: config, dispatch: dispatch });\n  });\n}\n\nfunction getRequestToken(_ref2) {\n  var window = _ref2.window,\n      config = _ref2.config,\n      dispatch = _ref2.dispatch;\n\n  return new Promise(function (resolve, reject) {\n    return fetch(config.url, {\n      method: 'post',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        redirectUri: config.redirectUri\n      })\n    }).then(function (response) {\n      if (response.ok) {\n        return response.json().then(function (json) {\n          resolve({ window: window, config: config, requestToken: json, dispatch: dispatch });\n        });\n      }\n    });\n  });\n}\n\nfunction pollPopup(_ref3) {\n  var window = _ref3.window,\n      config = _ref3.config,\n      requestToken = _ref3.requestToken,\n      dispatch = _ref3.dispatch;\n\n  return new Promise(function (resolve, reject) {\n    var redirectUri = _url2.default.parse(config.redirectUri);\n    var redirectUriPath = redirectUri.host + redirectUri.pathname;\n\n    if (requestToken) {\n      window.location = config.authorizationUrl + '?' + _querystring2.default.stringify(requestToken);\n    }\n\n    var polling = setInterval(function () {\n      if (!window || window.closed) {\n        clearInterval(polling);\n      }\n      try {\n        var popupUrlPath = window.location.host + window.location.pathname;\n        if (popupUrlPath === redirectUriPath) {\n          if (window.location.search || window.location.hash) {\n            var query = _querystring2.default.parse(window.location.search.substring(1).replace(/\\/$/, ''));\n            var hash = _querystring2.default.parse(window.location.hash.substring(1).replace(/[\\/$]/, ''));\n            var params = Object.assign({}, query, hash);\n\n            if (params.error) {\n              dispatch({\n                type: 'OAUTH_FAILURE',\n                messages: [{ msg: params.error }]\n              });\n            } else {\n              resolve({ oauthData: params, config: config, window: window, interval: polling, dispatch: dispatch });\n            }\n          } else {\n            dispatch({\n              type: 'OAUTH_FAILURE',\n              messages: [{ msg: 'OAuth redirect has occurred but no query or hash parameters were found.' }]\n            });\n          }\n        }\n      } catch (error) {\n        // Ignore DOMException: Blocked a frame with origin from accessing a cross-origin frame.\n        // A hack to get around same-origin security policy errors in Internet Explorer.\n      }\n    }, 500);\n  });\n}\n\nfunction exchangeCodeForToken(_ref4) {\n  var oauthData = _ref4.oauthData,\n      config = _ref4.config,\n      window = _ref4.window,\n      interval = _ref4.interval,\n      dispatch = _ref4.dispatch;\n\n  return new Promise(function (resolve, reject) {\n    var data = Object.assign({}, oauthData, config);\n\n    return fetch(config.url, {\n      method: 'post',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'same-origin', // By default, fetch won't send any cookies to the server\n      body: JSON.stringify(data)\n    }).then(function (response) {\n      if (response.ok) {\n        return response.json().then(function (json) {\n          resolve({ token: json.token, user: json.user, window: window, interval: interval, dispatch: dispatch });\n        });\n      } else {\n        return response.json().then(function (json) {\n          dispatch({\n            type: 'OAUTH_FAILURE',\n            messages: Array.isArray(json) ? json : [json]\n          });\n          closePopup({ window: window, interval: interval });\n        });\n      }\n    });\n  });\n}\n\nfunction signIn(_ref5) {\n  var token = _ref5.token,\n      user = _ref5.user,\n      window = _ref5.window,\n      interval = _ref5.interval,\n      dispatch = _ref5.dispatch;\n\n  return new Promise(function (resolve, reject) {\n    dispatch({\n      type: 'OAUTH_SUCCESS',\n      token: token,\n      user: user\n    });\n    _reactCookie2.default.save('token', token, { expires: (0, _moment2.default)().add(1, 'hour').toDate() });\n    _reactRouter.browserHistory.push('/');\n    resolve({ window: window, interval: interval });\n  });\n}\n\nfunction closePopup(_ref6) {\n  var window = _ref6.window,\n      interval = _ref6.interval;\n\n  return new Promise(function (resolve, reject) {\n    clearInterval(interval);\n    window.close();\n    resolve();\n  });\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vYXBwL2FjdGlvbnMvb2F1dGguanM/ZGE2NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdXJsIGZyb20gJ3VybCc7XHJcbmltcG9ydCBxcyBmcm9tICdxdWVyeXN0cmluZyc7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IGNvb2tpZSBmcm9tICdyZWFjdC1jb29raWUnO1xyXG5pbXBvcnQgeyBicm93c2VySGlzdG9yeSB9IGZyb20gJ3JlYWN0LXJvdXRlcic7XHJcblxyXG4vLyBTaWduIGluIHdpdGggRmFjZWJvb2tcclxuZXhwb3J0IGZ1bmN0aW9uIGZhY2Vib29rTG9naW4oKSB7XHJcbiAgY29uc3QgZmFjZWJvb2sgPSB7XHJcbiAgICB1cmw6ICcvYXV0aC9mYWNlYm9vaycsXHJcbiAgICBjbGllbnRJZDogJzk4MDIyMDAwMjA2ODc4NycsXHJcbiAgICByZWRpcmVjdFVyaTogJy9hdXRoL2ZhY2Vib29rL2NhbGxiYWNrJyxcclxuICAgIGF1dGhvcml6YXRpb25Vcmw6ICdodHRwczovL3d3dy5mYWNlYm9vay5jb20vdjIuNS9kaWFsb2cvb2F1dGgnLFxyXG4gICAgc2NvcGU6ICdlbWFpbCx1c2VyX2xvY2F0aW9uJyxcclxuICAgIHdpZHRoOiA1ODAsXHJcbiAgICBoZWlnaHQ6IDQwMFxyXG4gIH07XHJcblxyXG4gIHJldHVybiAoZGlzcGF0Y2gpID0+IHtcclxuICAgIG9hdXRoMihmYWNlYm9vaywgZGlzcGF0Y2gpXHJcbiAgICAgIC50aGVuKG9wZW5Qb3B1cClcclxuICAgICAgLnRoZW4ocG9sbFBvcHVwKVxyXG4gICAgICAudGhlbihleGNoYW5nZUNvZGVGb3JUb2tlbilcclxuICAgICAgLnRoZW4oc2lnbkluKVxyXG4gICAgICAudGhlbihjbG9zZVBvcHVwKTtcclxuICB9O1xyXG59XHJcblxyXG4vLyBTaWduIGluIHdpdGggVHdpdHRlclxyXG5leHBvcnQgZnVuY3Rpb24gdHdpdHRlckxvZ2luKCkge1xyXG4gIGNvbnN0IHR3aXR0ZXIgPSB7XHJcbiAgICB1cmw6ICcvYXV0aC90d2l0dGVyJyxcclxuICAgIHJlZGlyZWN0VXJpOiAnL2F1dGgvdHdpdHRlci9jYWxsYmFjaycsXHJcbiAgICBhdXRob3JpemF0aW9uVXJsOiAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvYXV0aGVudGljYXRlJ1xyXG4gIH07XHJcblxyXG4gIHJldHVybiAoZGlzcGF0Y2gpID0+IHtcclxuICAgIG9hdXRoMSh0d2l0dGVyLCBkaXNwYXRjaClcclxuICAgICAgLnRoZW4ob3BlblBvcHVwKVxyXG4gICAgICAudGhlbihnZXRSZXF1ZXN0VG9rZW4pXHJcbiAgICAgIC50aGVuKHBvbGxQb3B1cClcclxuICAgICAgLnRoZW4oZXhjaGFuZ2VDb2RlRm9yVG9rZW4pXHJcbiAgICAgIC50aGVuKHNpZ25JbilcclxuICAgICAgLnRoZW4oY2xvc2VQb3B1cCk7XHJcbiAgfTtcclxufVxyXG5cclxuLy8gU2lnbiBpbiB3aXRoIEdvb2dsZVxyXG5leHBvcnQgZnVuY3Rpb24gZ29vZ2xlTG9naW4oKSB7XHJcbiAgY29uc3QgZ29vZ2xlID0ge1xyXG4gICAgdXJsOiAnL2F1dGgvZ29vZ2xlJyxcclxuICAgIGNsaWVudElkOiAnODE0OTU4OTkwNzk2LXAxY2VudGplYnYxazBodHAzYW0wNXRmZzVrMTBubDBrLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tJyxcclxuICAgIHJlZGlyZWN0VXJpOiAnL2F1dGgvZ29vZ2xlL2NhbGxiYWNrJyxcclxuICAgIGF1dGhvcml6YXRpb25Vcmw6ICdodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aCcsXHJcbiAgICBzY29wZTogJ29wZW5pZCBwcm9maWxlIGVtYWlsJyxcclxuICAgIHdpZHRoOiA0NTIsXHJcbiAgICBoZWlnaHQ6IDYzM1xyXG4gIH07XHJcblxyXG4gIHJldHVybiAoZGlzcGF0Y2gpID0+IHtcclxuICAgIG9hdXRoMihnb29nbGUsIGRpc3BhdGNoKVxyXG4gICAgICAudGhlbihvcGVuUG9wdXApXHJcbiAgICAgIC50aGVuKHBvbGxQb3B1cClcclxuICAgICAgLnRoZW4oZXhjaGFuZ2VDb2RlRm9yVG9rZW4pXHJcbiAgICAgIC50aGVuKHNpZ25JbilcclxuICAgICAgLnRoZW4oY2xvc2VQb3B1cCk7XHJcbiAgfTtcclxufVxyXG5cclxuLy8gTGluayBhY2NvdW50XHJcbmV4cG9ydCBmdW5jdGlvbiBsaW5rKHByb3ZpZGVyKSB7XHJcbiAgc3dpdGNoIChwcm92aWRlcikge1xyXG4gICAgY2FzZSAnZmFjZWJvb2snOlxyXG4gICAgICByZXR1cm4gZmFjZWJvb2tMb2dpbigpO1xyXG4gICAgY2FzZSAndHdpdHRlcic6XHJcbiAgICAgIHJldHVybiB0d2l0dGVyTG9naW4oKTtcclxuICAgIGNhc2UgJ2dvb2dsZSc6XHJcbiAgICAgIHJldHVybiBnb29nbGVMb2dpbigpO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiAnTElOS19GQUlMVVJFJyxcclxuICAgICAgICBtZXNzYWdlczogW3sgbXNnOiAnSW52YWxpZCBPQXV0aCBQcm92aWRlcicgfV1cclxuICAgICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gVW5saW5rIGFjY291bnRcclxuZXhwb3J0IGZ1bmN0aW9uIHVubGluayhwcm92aWRlcikge1xyXG4gIHJldHVybiAoZGlzcGF0Y2gpID0+IHtcclxuICAgIHJldHVybiBmZXRjaCgnL3VubGluay8nICsgcHJvdmlkZXIpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkudGhlbigoanNvbikgPT4ge1xyXG4gICAgICAgICAgZGlzcGF0Y2goe1xyXG4gICAgICAgICAgICB0eXBlOiAnVU5MSU5LX1NVQ0NFU1MnLFxyXG4gICAgICAgICAgICBtZXNzYWdlczogW2pzb25dXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLnRoZW4oKGpzb24pID0+IHtcclxuICAgICAgICAgIGRpc3BhdGNoKHtcclxuICAgICAgICAgICAgdHlwZTogJ1VOTElOS19GQUlMVVJFJyxcclxuICAgICAgICAgICAgbWVzc2FnZXM6IFtqc29uXVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gb2F1dGgyKGNvbmZpZywgZGlzcGF0Y2gpIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICBjbGllbnRfaWQ6IGNvbmZpZy5jbGllbnRJZCxcclxuICAgICAgcmVkaXJlY3RfdXJpOiBjb25maWcucmVkaXJlY3RVcmksXHJcbiAgICAgIHNjb3BlOiBjb25maWcuc2NvcGUsXHJcbiAgICAgIGRpc3BsYXk6ICdwb3B1cCcsXHJcbiAgICAgIHJlc3BvbnNlX3R5cGU6ICdjb2RlJ1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHVybCA9IGNvbmZpZy5hdXRob3JpemF0aW9uVXJsICsgJz8nICsgcXMuc3RyaW5naWZ5KHBhcmFtcyk7XHJcbiAgICByZXNvbHZlKHsgdXJsOiB1cmwsIGNvbmZpZzogY29uZmlnLCBkaXNwYXRjaDogZGlzcGF0Y2ggfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9hdXRoMShjb25maWcsIGRpc3BhdGNoKSB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIHJlc29sdmUoeyB1cmw6ICdhYm91dDpibGFuaycsIGNvbmZpZzogY29uZmlnLCBkaXNwYXRjaDogZGlzcGF0Y2ggfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Qb3B1cCh7IHVybCwgY29uZmlnLCBkaXNwYXRjaCB9KSB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IHdpZHRoID0gY29uZmlnLndpZHRoIHx8IDUwMDtcclxuICAgIGNvbnN0IGhlaWdodCA9IGNvbmZpZy5oZWlnaHQgfHwgNTAwO1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgd2lkdGg6IHdpZHRoLFxyXG4gICAgICBoZWlnaHQ6IGhlaWdodCxcclxuICAgICAgdG9wOiB3aW5kb3cuc2NyZWVuWSArICgod2luZG93Lm91dGVySGVpZ2h0IC0gaGVpZ2h0KSAvIDIuNSksXHJcbiAgICAgIGxlZnQ6IHdpbmRvdy5zY3JlZW5YICsgKCh3aW5kb3cub3V0ZXJXaWR0aCAtIHdpZHRoKSAvIDIpXHJcbiAgICB9O1xyXG4gICAgY29uc3QgcG9wdXAgPSB3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnLCBxcy5zdHJpbmdpZnkob3B0aW9ucywgJywnKSk7XHJcblxyXG4gICAgaWYgKHVybCA9PT0gJ2Fib3V0OmJsYW5rJykge1xyXG4gICAgICBwb3B1cC5kb2N1bWVudC5ib2R5LmlubmVySFRNTCA9ICdMb2FkaW5nLi4uJztcclxuICAgIH1cclxuXHJcbiAgICByZXNvbHZlKHsgd2luZG93OiBwb3B1cCwgY29uZmlnOiBjb25maWcsIGRpc3BhdGNoOiBkaXNwYXRjaCB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0UmVxdWVzdFRva2VuKHsgd2luZG93LCBjb25maWcsIGRpc3BhdGNoIH0pIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgcmV0dXJuIGZldGNoKGNvbmZpZy51cmwsIHtcclxuICAgICAgbWV0aG9kOiAncG9zdCcsXHJcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgcmVkaXJlY3RVcmk6IGNvbmZpZy5yZWRpcmVjdFVyaVxyXG4gICAgICB9KVxyXG4gICAgfSkudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKS50aGVuKChqc29uKSA9PiB7XHJcbiAgICAgICAgICByZXNvbHZlKHsgd2luZG93OiB3aW5kb3csIGNvbmZpZzogY29uZmlnLCByZXF1ZXN0VG9rZW46IGpzb24sIGRpc3BhdGNoOiBkaXNwYXRjaCB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBvbGxQb3B1cCh7IHdpbmRvdywgY29uZmlnLCByZXF1ZXN0VG9rZW4sIGRpc3BhdGNoIH0pIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY29uc3QgcmVkaXJlY3RVcmkgPSB1cmwucGFyc2UoY29uZmlnLnJlZGlyZWN0VXJpKTtcclxuICAgIGNvbnN0IHJlZGlyZWN0VXJpUGF0aCA9IHJlZGlyZWN0VXJpLmhvc3QgKyByZWRpcmVjdFVyaS5wYXRobmFtZTtcclxuXHJcbiAgICBpZiAocmVxdWVzdFRva2VuKSB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IGNvbmZpZy5hdXRob3JpemF0aW9uVXJsICsgJz8nICsgcXMuc3RyaW5naWZ5KHJlcXVlc3RUb2tlbik7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcG9sbGluZyA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgaWYgKCF3aW5kb3cgfHwgd2luZG93LmNsb3NlZCkge1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwocG9sbGluZyk7XHJcbiAgICAgIH1cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwb3B1cFVybFBhdGggPSB3aW5kb3cubG9jYXRpb24uaG9zdCArIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTtcclxuICAgICAgICBpZiAocG9wdXBVcmxQYXRoID09PSByZWRpcmVjdFVyaVBhdGgpIHtcclxuICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uc2VhcmNoIHx8IHdpbmRvdy5sb2NhdGlvbi5oYXNoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5ID0gcXMucGFyc2Uod2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSkucmVwbGFjZSgvXFwvJC8sICcnKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhc2ggPSBxcy5wYXJzZSh3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSkucmVwbGFjZSgvW1xcLyRdLywgJycpKTtcclxuICAgICAgICAgICAgY29uc3QgcGFyYW1zID0gT2JqZWN0LmFzc2lnbih7fSwgcXVlcnksIGhhc2gpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBhcmFtcy5lcnJvcikge1xyXG4gICAgICAgICAgICAgIGRpc3BhdGNoKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdPQVVUSF9GQUlMVVJFJyxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbeyBtc2c6IHBhcmFtcy5lcnJvciB9XVxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHJlc29sdmUoeyBvYXV0aERhdGE6IHBhcmFtcywgY29uZmlnOiBjb25maWcsIHdpbmRvdzogd2luZG93LCBpbnRlcnZhbDogcG9sbGluZywgZGlzcGF0Y2g6IGRpc3BhdGNoIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkaXNwYXRjaCh7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ09BVVRIX0ZBSUxVUkUnLFxyXG4gICAgICAgICAgICAgIG1lc3NhZ2VzOiBbeyBtc2c6ICdPQXV0aCByZWRpcmVjdCBoYXMgb2NjdXJyZWQgYnV0IG5vIHF1ZXJ5IG9yIGhhc2ggcGFyYW1ldGVycyB3ZXJlIGZvdW5kLicgfV1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIC8vIElnbm9yZSBET01FeGNlcHRpb246IEJsb2NrZWQgYSBmcmFtZSB3aXRoIG9yaWdpbiBmcm9tIGFjY2Vzc2luZyBhIGNyb3NzLW9yaWdpbiBmcmFtZS5cclxuICAgICAgICAvLyBBIGhhY2sgdG8gZ2V0IGFyb3VuZCBzYW1lLW9yaWdpbiBzZWN1cml0eSBwb2xpY3kgZXJyb3JzIGluIEludGVybmV0IEV4cGxvcmVyLlxyXG4gICAgICB9XHJcbiAgICB9LCA1MDApO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBleGNoYW5nZUNvZGVGb3JUb2tlbih7IG9hdXRoRGF0YSwgY29uZmlnLCB3aW5kb3csIGludGVydmFsLCBkaXNwYXRjaCB9KSB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IGRhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBvYXV0aERhdGEsIGNvbmZpZyk7XHJcblxyXG4gICAgcmV0dXJuIGZldGNoKGNvbmZpZy51cmwsIHtcclxuICAgICAgbWV0aG9kOiAncG9zdCcsXHJcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxyXG4gICAgICBjcmVkZW50aWFsczogJ3NhbWUtb3JpZ2luJywgLy8gQnkgZGVmYXVsdCwgZmV0Y2ggd29uJ3Qgc2VuZCBhbnkgY29va2llcyB0byB0aGUgc2VydmVyXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXHJcbiAgICB9KS50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLnRoZW4oKGpzb24pID0+IHtcclxuICAgICAgICAgIHJlc29sdmUoeyB0b2tlbjoganNvbi50b2tlbiwgdXNlcjoganNvbi51c2VyLCB3aW5kb3c6IHdpbmRvdywgaW50ZXJ2YWw6IGludGVydmFsLCBkaXNwYXRjaDogZGlzcGF0Y2ggfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKS50aGVuKChqc29uKSA9PiB7XHJcbiAgICAgICAgICBkaXNwYXRjaCh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdPQVVUSF9GQUlMVVJFJyxcclxuICAgICAgICAgICAgbWVzc2FnZXM6IEFycmF5LmlzQXJyYXkoanNvbikgPyBqc29uIDogW2pzb25dXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGNsb3NlUG9wdXAoeyB3aW5kb3c6IHdpbmRvdywgaW50ZXJ2YWw6IGludGVydmFsIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2lnbkluKHsgdG9rZW4sIHVzZXIsIHdpbmRvdywgaW50ZXJ2YWwsIGRpc3BhdGNoIH0pIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgZGlzcGF0Y2goe1xyXG4gICAgICB0eXBlOiAnT0FVVEhfU1VDQ0VTUycsXHJcbiAgICAgIHRva2VuOiB0b2tlbixcclxuICAgICAgdXNlcjogdXNlclxyXG4gICAgfSk7XHJcbiAgICBjb29raWUuc2F2ZSgndG9rZW4nLCB0b2tlbiwgeyBleHBpcmVzOiBtb21lbnQoKS5hZGQoMSwgJ2hvdXInKS50b0RhdGUoKSB9KTtcclxuICAgIGJyb3dzZXJIaXN0b3J5LnB1c2goJy8nKTtcclxuICAgIHJlc29sdmUoeyB3aW5kb3c6IHdpbmRvdywgaW50ZXJ2YWw6IGludGVydmFsIH0pO1xyXG4gIH0pO1xyXG5cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGNsb3NlUG9wdXAoeyB3aW5kb3csIGludGVydmFsIH0pIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XHJcbiAgICB3aW5kb3cuY2xvc2UoKTtcclxuICAgIHJlc29sdmUoKTtcclxuICB9KTtcclxufVxyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYXBwL2FjdGlvbnMvb2F1dGguanMiXSwibWFwcGluZ3MiOiI7Ozs7O0FBT0E7QUFzQkE7QUFtQkE7QUFzQkE7QUFpQkE7QUFDQTtBQXhGQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQUtBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQVJBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ })

})